{% extends 'base.html' %}

{% block title %}Profile - LearnAI{% endblock %}

{% block content %}
<section class="profile-section">
    <div class="container">
        <!-- Profile Header -->
        <div class="profile-header">
            <div class="profile-avatar">
                {% if user.avatar %}
                <img src="{{ user.avatar.url }}" alt="{{ user.get_display_name }}">
                {% else %}
                <div class="avatar-placeholder">
                    {{ user.username|slice:":1"|upper }}
                </div>
                {% endif %}
            </div>
            <div class="profile-info">
                <h1>{{ user.get_display_name }}</h1>
                <p class="profile-email">{{ user.email }}</p>
                <div class="profile-badges">
                    <span class="badge badge-level">Level {{ profile.level }}</span>
                    <span class="badge badge-xp">{{ profile.xp_points }} XP</span>
                    {% if profile.streak_days > 0 %}
                    <span class="badge badge-streak">{{ profile.streak_days }} Day Streak</span>
                    {% endif %}
                </div>
            </div>
            <div class="profile-actions">
                <a href="{% url 'accounts:profile_edit' %}" class="btn btn-secondary">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7" />
                        <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z" />
                    </svg>
                    Edit Profile
                </a>
                <a href="{% url 'accounts:logout' %}" class="btn btn-outline">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" />
                        <polyline points="16 17 21 12 16 7" />
                        <line x1="21" y1="12" x2="9" y2="12" />
                    </svg>
                    Logout
                </a>
            </div>
        </div>

        <!-- Stats Grid -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                        <line x1="12" y1="17" x2="12.01" y2="17" />
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ profile.total_quizzes_taken }}</span>
                    <span class="stat-label">Quizzes Taken</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="9 11 12 14 22 4" />
                        <path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11" />
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ profile.accuracy_percentage }}%</span>
                    <span class="stat-label">Accuracy Rate</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <rect x="2" y="4" width="20" height="16" rx="2" />
                        <path d="M7 8h10" />
                        <path d="M7 12h6" />
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ profile.total_flashcards_reviewed }}</span>
                    <span class="stat-label">Flashcards Reviewed</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                        <polyline points="14,2 14,8 20,8" />
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ profile.total_documents_uploaded }}</span>
                    <span class="stat-label">Documents Uploaded</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10" />
                        <polyline points="12,6 12,12 16,14" />
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ profile.total_study_time_minutes }}</span>
                    <span class="stat-label">Minutes Studied</span>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <svg width="28" height="28" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12 2v4" />
                        <path d="m16.24 7.76 2.83-2.83" />
                        <path d="M18 12h4" />
                        <path d="m16.24 16.24 2.83 2.83" />
                        <path d="M12 18v4" />
                        <path d="m4.93 19.07 2.83-2.83" />
                        <path d="M2 12h4" />
                        <path d="m4.93 4.93 2.83 2.83" />
                    </svg>
                </div>
                <div class="stat-content">
                    <span class="stat-value">{{ profile.longest_streak }}</span>
                    <span class="stat-label">Longest Streak</span>
                </div>
            </div>
        </div>

        <!-- XP Progress -->
        <div class="xp-section">
            <div class="xp-card">
                <div class="xp-header">
                    <h3>Level Progress</h3>
                    <span class="xp-level">Level {{ profile.level }}</span>
                </div>
                <div class="xp-bar-container">
                    {% widthratio profile.xp_points 1000 100 as xp_percent %}
                    <div class="xp-bar" style="width: {{ xp_percent|default:0 }}%"></div>
                </div>
                <div class="xp-info">
                    <span>{{ profile.xp_points }} XP</span>
                    <span>{{ profile.level|add:1 }}000 XP to Level {{ profile.level|add:1 }}</span>
                </div>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <h2>Continue Learning</h2>
            <div class="actions-grid">
                <a href="{% url 'summaries' %}" class="action-card action-card-primary">
                    <div class="action-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z" />
                            <polyline points="14,2 14,8 20,8" />
                            <line x1="16" y1="13" x2="8" y2="13" />
                            <line x1="16" y1="17" x2="8" y2="17" />
                            <line x1="10" y1="9" x2="8" y2="9" />
                        </svg>
                    </div>
                    <span>AI Summary</span>
                </a>
                <a href="{% url 'quizzes' %}" class="action-card">
                    <div class="action-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <circle cx="12" cy="12" r="10" />
                            <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" />
                            <line x1="12" y1="17" x2="12.01" y2="17" />
                        </svg>
                    </div>
                    <span>Take a Quiz</span>
                </a>
                <a href="{% url 'flashcards' %}" class="action-card">
                    <div class="action-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <rect x="2" y="4" width="20" height="16" rx="2" />
                            <path d="M7 8h10" />
                            <path d="M7 12h6" />
                        </svg>
                    </div>
                    <span>Study Flashcards</span>
                </a>
                <a href="{% url 'analytics' %}" class="action-card">
                    <div class="action-icon">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2">
                            <line x1="18" y1="20" x2="18" y2="10" />
                            <line x1="12" y1="20" x2="12" y2="4" />
                            <line x1="6" y1="20" x2="6" y2="14" />
                        </svg>
                    </div>
                    <span>View Analytics</span>
                </a>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_css %}
<style>
    .profile-section {
        padding: 7rem 0 4rem;
    }

    .profile-header {
        display: flex;
        align-items: center;
        gap: 2rem;
        background: var(--gradient-card);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-xl);
        padding: 2.5rem;
        margin-bottom: 2rem;
        backdrop-filter: var(--glass-blur);
    }

    .profile-avatar {
        flex-shrink: 0;
    }

    .profile-avatar img,
    .avatar-placeholder {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        object-fit: cover;
    }

    .avatar-placeholder {
        background: var(--gradient-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--bg-primary);
    }

    .profile-info {
        flex-grow: 1;
    }

    .profile-info h1 {
        font-size: 2rem;
        margin-bottom: 0.25rem;
    }

    .profile-email {
        color: var(--text-secondary);
        margin-bottom: 1rem;
    }

    .profile-badges {
        display: flex;
        gap: 0.75rem;
        flex-wrap: wrap;
    }

    .badge {
        display: inline-flex;
        align-items: center;
        padding: 0.375rem 0.875rem;
        border-radius: var(--radius-sm);
        font-size: 0.85rem;
        font-weight: 500;
    }

    .badge-level {
        background: var(--gradient-primary);
        color: var(--bg-primary);
    }

    .badge-xp {
        background: rgba(0, 217, 192, 0.15);
        color: var(--accent-primary);
        border: 1px solid var(--accent-primary);
    }

    .badge-streak {
        background: rgba(251, 191, 36, 0.15);
        color: #fbbf24;
        border: 1px solid #fbbf24;
    }

    .profile-actions {
        display: flex;
        gap: 0.75rem;
        flex-shrink: 0;
    }

    /* Stats Grid */
    .stats-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: 1.5rem;
        margin-bottom: 2rem;
    }

    .stat-card {
        background: var(--gradient-card);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: 1.5rem;
        display: flex;
        align-items: center;
        gap: 1rem;
        backdrop-filter: var(--glass-blur);
        transition: all var(--transition-normal);
    }

    .stat-card:hover {
        border-color: var(--accent-primary);
        box-shadow: var(--shadow-glow);
    }

    .stat-icon {
        width: 56px;
        height: 56px;
        background: var(--gradient-primary);
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        color: var(--bg-primary);
        flex-shrink: 0;
    }

    .stat-content {
        display: flex;
        flex-direction: column;
    }

    .stat-value {
        font-size: 1.75rem;
        font-weight: 700;
        line-height: 1.2;
    }

    .stat-label {
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    /* XP Section */
    .xp-section {
        margin-bottom: 2rem;
    }

    .xp-card {
        background: var(--gradient-card);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        padding: 1.5rem 2rem;
        backdrop-filter: var(--glass-blur);
    }

    .xp-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .xp-header h3 {
        margin: 0;
    }

    .xp-level {
        background: var(--gradient-primary);
        color: var(--bg-primary);
        padding: 0.375rem 1rem;
        border-radius: var(--radius-sm);
        font-weight: 600;
    }

    .xp-bar-container {
        width: 100%;
        height: 12px;
        background: var(--bg-tertiary);
        border-radius: 6px;
        overflow: hidden;
        margin-bottom: 0.75rem;
    }

    .xp-bar {
        height: 100%;
        background: var(--gradient-primary);
        border-radius: 6px;
        transition: width 0.5s ease;
    }

    .xp-info {
        display: flex;
        justify-content: space-between;
        color: var(--text-secondary);
        font-size: 0.9rem;
    }

    /* Quick Actions */
    .quick-actions {
        margin-top: 2rem;
    }

    .quick-actions h2 {
        margin-bottom: 1.5rem;
    }

    .actions-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
        gap: 1rem;
    }

    .action-card {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        padding: 1.5rem;
        background: var(--gradient-card);
        border: 1px solid var(--glass-border);
        border-radius: var(--radius-lg);
        text-decoration: none;
        color: var(--text-primary);
        transition: all var(--transition-normal);
    }

    .action-card:hover {
        transform: translateY(-5px);
        border-color: var(--accent-primary);
        box-shadow: var(--shadow-glow);
        color: var(--accent-primary);
    }

    .action-icon {
        width: 56px;
        height: 56px;
        background: var(--bg-tertiary);
        border-radius: var(--radius-md);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all var(--transition-normal);
    }

    .action-card-primary {
        border-color: var(--accent-primary);
        background: linear-gradient(135deg, rgba(0, 217, 192, 0.1) 0%, rgba(0, 143, 122, 0.05) 100%);
    }

    .action-card-primary .action-icon {
        background: var(--gradient-primary);
        color: var(--bg-primary);
    }

    .action-card:hover .action-icon {
        background: var(--gradient-primary);
        color: var(--bg-primary);
    }

    @media (max-width: 768px) {
        .profile-header {
            flex-direction: column;
            text-align: center;
        }

        .profile-badges {
            justify-content: center;
        }

        .profile-actions {
            width: 100%;
            flex-direction: column;
        }

        .profile-actions .btn {
            width: 100%;
            justify-content: center;
        }
    }
</style>
{% endblock %}